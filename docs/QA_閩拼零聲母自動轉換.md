# 閩拼方案零聲母自動轉換功能

## 功能說明

為了方便使用者適應閩拼方案的零聲母處理規則，在 `bp_phing_im.schema.yaml` 中添加了自動轉換功能：

### 輸入轉換規則

當使用者輸入台語音標格式時，系統會自動轉換成閩拼（BP）格式：

#### i 開頭的零聲母轉換
- `i1` → `yi1` （伊）
- `iong2` → `yong2` （楊）
- `iang1` → `yang1` （鞅）
- `iao1` → `yao1` （枵）
- `ian2` → `yan2` （演）
- `iam3` → `yam3` （豔）
- `ing1` → `ying1` （英）
- `ik8` → `yik8` （益）
- `in1` → `yin1` （因）
- `it8` → `yit8` （一）
- `im1` → `yim1` （音）
- `ip8` → `yip8` （揖）

#### u 開頭的零聲母轉換
- `u3` → `wu3` （有）
- `un2` → `wun2` （溫）
- `ut8` → `wut8` （兀）
- `uh4` → `wuh4` （挖）
- `uan2` → `wan2` （彎）
- `uai7` → `wai7` （歪）
- `uang1` → `wang1` （光）
- `ue3` → `we3` （衛）
- `ui7` → `wi7` （位）

### 實現方式

#### 1. speller/algebra 規則

在字典查詢階段進行轉換，讓台語音標格式的輸入能匹配到 BP 格式的字典詞條。

```yaml
# i 開頭的零聲母自動轉換
- derive/^i(ong|ok)(\d)$/y$1$2/      # iong2 → yong2
- derive/^i(\d)$/yi$1/               # i1 → yi1
# u 開頭的零聲母自動轉換
- derive/^u(\d)$/wu$1/               # u3 → wu3
- derive/^u(a[inp]?)(\d)$/w$1$2/     # uan2 → wan2
```

#### 2. preedit_format 規則
在輸入介面顯示轉換後的結果，讓使用者看到標準的 BP 格式。

```yaml
# i 開頭的零聲母轉換顯示
- xform/\bi(ong|ok)(\d)/y$1$2/       # iong2 → yong2
- xform/\bi(\d)/yi$1/                # i1 → yi1
# u 開頭的零聲母轉換顯示
- xform/\bu(\d)/wu$1/                # u3 → wu3
- xform/\bu(a[inp]?)(\d)/w$1$2/      # uan2 → wan2
```

## 使用效果

### 輸入體驗

- 使用者可以輸入熟悉的台語音標格式：`iong2`
- 輸入介面自動顯示 BP 格式：`yong2`
- 候選字正常顯示：`楊 〔yong2〕 【ㄧㄨㆭ²】`

### 相容性

- 保持與原有 BP 格式輸入的完全相容
- 同時支援台語音標格式輸入
- 不影響其他聲母的正常使用

## 測試案例

| 輸入 | 顯示 | 候選字 | 說明 |
|------|------|--------|------|
| `i1` | `yi1` | 伊 | 零聲母單純韻母 |
| `iong2` | `yong2` | 楊 | 零聲母複合韻母 |
| `u3` | `wu3` | 有 | 零聲母單純韻母 |
| `uan2` | `wan2` | 彎 | 零聲母介音韻母 |
| `yi1` | `yi1` | 伊 | 原 BP 格式不變 |
| `kong1` | `kong1` | 公 | 有聲母不受影響 |

## 注意事項

1. **轉換優先級**：台語音標格式會被轉換成 BP 格式進行字典查詢
2. **顯示一致性**：無論輸入何種格式，都會顯示標準的 BP 格式
3. **學習漸進**：使用者可以逐步學習 BP 格式，同時保持輸入習慣