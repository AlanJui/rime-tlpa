# Rime schema
# vim: set sw=2 sts=2 et:
# encoding: utf-8

schema:
  schema_id: tlpa_cu_im
  name: 河洛注音
  version: "v0.0.0.1"
  author: 居正中
  description: |
    河洛話白話音, 採用「TLPA標音方案」
    以「白話音」為主；「文讀音」為輔。

    鍵盤對應：
      ㄅ ㄉ ３ ２ ７ ５ ． ㄚ ㄞ ㄢ ｎ
      ㄆ ㄊ ㄍ ㄐ ㆣ ㄗ ㄧ ㆦ ㆤ ㄣ
      ㄇ ㄋ ㄎ ㄑ ㄫ ㄘ ㄨ ㄜ ㄠ ㄤ
      ㆠ ㄌ ㄏ ㄒ Ｊ ㄙ ㆬ ㆰ ㆲ ㆭ

switches:
  - name: ascii_mode
    reset: 0
    states: [台文, ABC]
  - name: full_shape
    reset: 0
    states: [半形, 全形]

engine:
  processors:
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - echo_translator
    - punct_translator
    - r10n_translator
    - reverse_lookup_translator
  filters:
    - simplifier
    - uniquifier

speller:
  alphabet: 'abcdefghijklmnopqrstuvwxyz~[/\]90-;'
  initials: abcdefghijklmnopqrstuvwxyz
  delimiter: " '"
  algebra:
    # 去掉聲調
    # - derive/[1-8]//
    # 零聲母處理
    - derive/q//
    - derive/Ø//
    # 通配
    - derive/ts/c/
    - derive/ou/oo/
    - derive/e(ng|k)/i$1/
    - derive/ei/e/
    # 鼻化韻處理
    - derive/([^u])enn/$1eenn/
    - xform/b(.+)nn/m$1/
    - xform/l(.+)nn/n$1/
    - xform/g(.+)nn/ng$1/
    - derive/([^blg])(.+)nn/$1$2/
    # 聲母簡拼
    - abbrev/^([lpktcjsqbghmn])([^hsg]).+$/$1/
    - abbrev/^(ph).+$/$1/
    - abbrev/^(th).+$/$1/
    - abbrev/^(kh).+$/$1/
    - abbrev/^(ng).+$/$1/
    - abbrev/^(ts).+$/$1/
    - abbrev/^(tsh).+$/$1/
    #==========================================
    - derive/^([Øa-z]+)\d$/$1/
    - abbrev/^([ptkmnbglsjhiuc]g?s?h?h?).*/$1/
    - 'xlit 12345678 [/\]90-;'
    # 標調號
    - "xform 1 ¹"
    - "xform 2 ²"
    - "xform 3 ³"
    - "xform 4 ⁴"
    - "xform 5 ⁵"
    - "xform 6 ⁶"
    - "xform 7 ⁷"
    - "xform 8 ⁸"

translator:
  dictionary: tlpa_peh_ue
  spelling_hints: 5
  preedit_format:
    #======================================================
    # 對於已輸入（韻母）（調號）之拼音，需在韻母標「聲調符號」
    #======================================================
    - xlit|[/\]90-;|¹²³⁴⁵⁶⁷⁸|
    - xform/([aeiou])(r?m?n*h?g?p?t?k?)([12345678])/$1$2$3/
    - xform/([aeo])([iueo])([12345678])/$1$2$3/
    #======================================================
    # 鼻化符號顯示成上標
    #======================================================
    - xform/nn(h?)(\d|\>)/$1ⁿ$2/
  # comment_format:
  #   # # 標調號
  #   # - "xform 1 ¹"
  #   # - "xform 2 ²"
  #   # - "xform 3 ³"
  #   # - "xform 4 ⁴"
  #   # - "xform 5 ⁵"
  #   # - "xform 6 ⁶"
  #   # - "xform 7 ⁷"
  #   # - "xform 8 ⁸"
  #   #======================================================
  #   # 顯示「方音符號」的聲母
  #   #======================================================
  #   - xform/^ch/ㄘ/
  #   - xform/^c(?!h)/ㄗ/
  #   #------------------------------------------------------
  #   - xform/^p(?!h)/ㄅ/
  #   - xform/^ph/ㄆ/
  #   - xform/^m/ㄇ/
  #   - xform/^b/ㆠ/
  #   #------------------------------------------------------
  #   - xform/^t(?!h)/ㄉ/
  #   - xform/^th/ㄊ/
  #   - xform/^n(?!g)/ㄋ/
  #   - xform/^l/ㄌ/
  #   #------------------------------------------------------
  #   - xform/^k(?!h)/ㄍ/
  #   - xform/^kh/ㄎ/
  #   - xform/^h/ㄏ/
  #   - xform/^g/ㆣ/
  #   - xform/^ng/ㄫ/
  #   #------------------------------------------------------
  #   - xform/s/ㄙ/
  #   - xform/j/ㆡ/
  #   #======================================================
  #   # 自「雅俗通十五音」轉化而得的韻母
  #   #======================================================
  #   - xform/iang/ㄧㄤ/  # 姜
  #   - xform/iak/ㄧㄚㆻ/  # 姜
  #   - xform/iong/ㄧㆲ/  # 恭
  #   - xform/iok/ㄧㆦㆻ/  # 恭
  #   - xform/ing/ㄧㄥ/  # 經
  #   - xform/ik/ㄧㆻ/  # 經
  #   - xform/iam/ㄧㆰ/  # 兼
  #   - xform/iap/ㄧㄚㆴ/  # 兼
  #   - xform/ian/ㄧㄢ/  # 堅
  #   - xform/iat/ㄧㄚㆵ/  # 堅
  #   - xform/iann/ㄧㆩ/  # 驚
  #   - xform/iau/ㄧㄠ/  # 嬌
  #   - xform/iauh/ㄧㄠㆷ/  # 嬌
  #   - xform/iaunn/ㄧㆯ/  # 嘄
  #   - xform/iaunnh/ㄧㆯㆷ/  # 嘄
  #   - xform/ia(?!n)/ㄧㄚ/  # 迦
  #   - xform/iah/ㄧㄚㆷ/  # 迦
  #   - xform/im/ㄧㆬ/  # 金
  #   - xform/ip/一ㆴ/  # 金
  #   - xform/in/ㄧㄣ/  # 巾
  #   - xform/it/ㄧㆵ/  # 巾
  #   - xform/io/ㄧㄜ/  # 茄
  #   - xform/ioh/ㄧㄜㆷ/  # 茄
  #   - xform/ionn/ㄧㆧ/  # 薑
  #   - xform/iu/ㄧㄨ/  # 丩
  #   - xform/iunn/ㄧㆫ/  # 牛
  #   #------------------------------------------------------
  #   - xform/ai/ㄞ/  # 皆
  #   - xform/ainn/ㆮ/  # 閒
  #   - xform/am/ㆰ/  # 甘
  #   - xform/ap/ㄚㆴ/  # 甘
  #   - xform/an(?!g)/ㄢ/  # 干
  #   - xform/at/ㄚㆵ/  # 干
  #   - xform/ang/ㄤ/  # 江
  #   - xform/ak/ㄚㆻ/  # 江
  #   - xform/au/ㄠ/  # 交
  #   - xform/auh/ㄠㆷ/  # 交
  #   - xform/aunn/ㆯ/  # 爻
  #   #------------------------------------------------------
  #   - xform/ong/ㆲ/  # 公
  #   - xform/ok/ㆦㆻ/  # 公
  #   - xform/om/ㆱ/  # 箴
  #   - xform/op/ㆦㆴ/  # 箴
  #   #------------------------------------------------------
  #   - xform/uang/ㄨㄤ/  # 光
  #   - xform/uak/ㄨㄚㆻ/  # 光
  #   - xform/uai/ㄨㄞ/  # 乖
  #   - xform/uaih/ㄨㄞㆷ/  # 乖
  #   - xform/uann/ㄨㆩ/  # 官
  #   - xform/uainn/ㄨㆮ/  # 閂
  #   - xform/uainnh/ㄨㆮㆷ/  # 閂
  #   - xform/uan/ㄨㄢ/  # 觀
  #   - xform/uat/ㄨㄚㆵ/  # 觀
  #   - xform/ua/ㄨㄚ/  # 瓜
  #   - xform/uah/ㄨㄚㆷ/  # 瓜
  #   #------------------------------------------------------
  #   - xform/ue/ㄨㆤ/  # 檜
  #   - xform/ueh/ㄨㆤㆷ/  # 檜
  #   - xform/uenn/ㄨㆥ/  # 糜
  #   - xform/ui/ㄨㄧ/  # 規
  #   - xform/uinn/ㄨㆪ/  # 褌
  #   - xform/un/ㄨㄣ/  # 君
  #   - xform/ut/ㄨㆵ/  # 君
  #   #------------------------------------------------------
  #   - xform/a/ㄚ/  # 膠
  #   - xform/ah/ㄚㆷ/  # 膠
  #   - xform/ann/ㆩ/  # 監
  #   - xform/annh/ㆩㆷ/  # 監
  #
  #   - xform/e/ㆤ/  # 伽
  #   - xform/eh/ㆤㆷ/  # 伽
  #   - xform/enn/ㆥ/  # 更
  #   - xform/ennh/ㆥㆷ/  # 更
  #   - xform/ee/ㄝ/  # 嘉
  #   - xform/eeh/ㄝㆷ/  # 嘉
  #   - xform/ei/ㄟ/  # 稽
  #
  #   - xform/i/ㄧ/  # 居
  #   - xform/ih/ㄧㆷ/  # 居
  #   - xform/inn/ㆪ/  # 梔
  #   - xform/innh/ㆪㆷ/  # 梔
  #
  #   - xform/u/ㄨ/  # 艍
  #   - xform/uh/ㄨㆷ/  # 艍
  #
  #   - xform/oo/ㆦ/  # 沽
  #   - xform/ou/ㆦ/  # 沽
  #   - xform/ounn/ㆧ/  # 姑
  #   - xform/oonn/ㆧ/  # 姑
  #   - xform/onn/ㆧ/  # 姑
  #
  #   - xform/o/ㄜ/  # 高
  #   - xform/oh/ㄜㆷ/  # 高
  #   # - xform/onn/ㆧ/  # 扛
  #   # - xform/onnh/ㆧㆷ/  # 扛
  #   #======================================================
  #   # 韻化輔音
  #   #======================================================
  #   - xform/m/ㆬ/  # 姆
  #   - xform/ng/ㆭ/  # 鋼
  #   - xform/n(?!h)/ㄣ/
  #   #======================================================
  #   # 鼻音
  #   #======================================================
  #   - xform/nn/N/
  #   - xform/N((ㄧ|ㄨ)?(ㄧ|ㄨ|ㄚ|ㆦ|ㆤ|ㄞ|ㄠ))/$1N/
  #   - xform/ㄧN/ㆪ/
  #   - xform/ㄨN/ㆫ/
  #   - xform/ㄚN/ㆩ/
  #   - xform/ㆦN/ㆧ/
  #   - xform/ㆤN/ㆥ/
  #   - xform/ㄞN/ㆮ/
  #   - xform/ㄠN/ㆯ/
  #
  #   - xform/ㄧㄢㄣ/ㄧㆩ/  # 驚
  #   #======================================================
  #   # 校調
  #   #======================================================
  #   - xform/ㄜㄜ/ㆦ/
  #   # 調整 ㄗ ㄘ ㄙ ㆡ 轉 ㄐ ㄑ ㄒ ㆢ
  #   - xform/ㄗㄧ/ㄐㄧ/
  #   - xform/ㄘㄧ/ㄑㄧ/
  #   - xform/ㄙㄧ/ㄒㄧ/
  #   - xform/ㆡㄧ/ㆢㄧ/
  #   #======================================================
  #   # 入聲
  #   #======================================================
  #   - xform/p8/ㆴ̇/
  #   - xform/t8/ㆵ̇/
  #   - xform/k8/ㆻ̇
  #   - xform/h8/ㆷ̇/
  #
  #   - xform/p/ㆴ/
  #   - xform/t/ㆵ/
  #   - xform/k/ㆻ/
  #   - xform/h/ㆷ/
  #
  #   # ok 指 ook
  #   - xform/ㄜ([ ㆴ ㆵ ㆻ ㆷ])/ㆦ$1/
  #   #======================================================
  #   # 聲調
  #   #======================================================
  #   - 'xform 1 ˉ'    #1
  #   - 'xform 2 ˋ'    #2
  #   - 'xform 3 ˪'    #3
  #   - 'xform 4  '    #4
  #   - 'xform 5 ˊ'    #5
  #   # - 'xform 6  ̌'    #6
  #   - 'xform 7 ˫'    #7
  #   - 'xform 8 ˙'    #8

custom_phrase:
  dictionary: ""
  user_dict: custom_phrase
  db_class: stabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: 1

punctuator:
  import_preset: tlpa_utl_symbols

recognizer:
  patterns:
    email: ^[a-z][-_.0-9a-z]*@.*$
    uppercase: ^[A-Z][-_+.'0-9A-Za-z]*$
    url: ^(www[.]|https?:|ftp:|mailto:).*$
    punct: '`[^\s]$'

style:
  horizontal: false
