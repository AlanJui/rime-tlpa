# Rime schema
# vim: set sw=2 sts=2 et:
# encoding: utf-8
---
schema:
  schema_id: tlpa_kong_un
  name: 河洛廣韻
  version: "v0.0.0.1"
  author: 居正中
  description: TLPA 河洛話輸入法

switches:
  - name: ascii_mode
    reset: 0
    states: [中文, 西文]
  - name: full_shape
    states: [半角, 全角]

engine:
  processors:
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - echo_translator
    - punct_translator
    - r10n_translator
    - reverse_lookup_translator
  filters:
    - simplifier
    - uniquifier

speller:
  alphabet: 'abcdefghijklmnopqrstuvwxyz~[/\]90-;'
  initials: abcdefghijklmnopqrstuvwxyz
  delimiter: " '"
  algebra:
    # 去掉聲調
    # - derive/[1-8]//
    # 零聲母處理
    # - derive/Ø//
    #==========================================
    # - derive/^([Øa-z]+)\d$/$1/
    # - abbrev/^([ptkmnbglsjhiuc]g?s?h?h?).*/$1/
    # - 'xlit 12345678 [/\]90-;'
    #==========================================
    # 零聲母處理
    - derive/q//
    - derive/Ø//
    # 通配
    - derive/ts/c/
    - derive/ou/oo/
    - derive/e(ng|k)/i$1/
    - derive/ei/e/
    # 鼻化韻處理
    - derive/([^u])enn/$1eenn/
    - xform/b(.+)nn/m$1/
    - xform/l(.+)nn/n$1/
    - xform/g(.+)nn/ng$1/
    - derive/([^blg])(.+)nn/$1$2/
    # 聲母簡拼
    - abbrev/^([lpktcjsqbghmn])([^hsg]).+$/$1/
    - abbrev/^(ph).+$/$1/
    - abbrev/^(th).+$/$1/
    - abbrev/^(kh).+$/$1/
    - abbrev/^(ng).+$/$1/
    - abbrev/^(ts).+$/$1/
    - abbrev/^(tsh).+$/$1/
    #==========================================
    - derive/^([Øa-z]+)\d$/$1/
    - abbrev/^([ptkmnbglsjhiuc]g?s?h?h?).*/$1/
    - 'xlit 12345678 [/\]90-;'
    # 標調號
    - "xform 1 ¹"
    - "xform 2 ²"
    - "xform 3 ³"
    - "xform 4 ⁴"
    - "xform 5 ⁵"
    - "xform 6 ⁶"
    - "xform 7 ⁷"
    - "xform 8 ⁸"

translator:
  dictionary: tlpa_kong_un
  # prism: blg_taipak
  preedit_format:
    - 'xform ([aeiou])(r?m?n*h?g?p?t?k?)([\[/\\\]90\-;]) $1$3$2'
    - 'xform ([aeo])([iueo])([\[/\\\]90\-;]) $1$3$2'
    - 'xform a\[ a'
    - 'xform e\[ e'
    - 'xform i\[ i'
    - 'xform u\[ u'
    - 'xform o\[ o'
    - 'xform m\[ m'
    - 'xform ng\[ ng'
    - "xform a/ á"
    - "xform e/ é"
    - "xform i/ í"
    - "xform u/ ú"
    - "xform o/ ó"
    - "xform m/ ḿ"
    - "xform ng/ ńg"
    - 'xform a\\ à'
    - 'xform e\\ è'
    - 'xform i\\ ì'
    - 'xform u\\ ù'
    - 'xform o\\ ò'
    - 'xform ng\\ ǹg'
    - 'xform a\] a'
    - 'xform e\] e'
    - 'xform i\] i'
    - 'xform u\] u'
    - 'xform o\] o'
    - 'xform mh\] mh'
    - 'xform ngh\] ngh'
    - "xform a9 â"
    - "xform e9 ê"
    - "xform i9 î"
    - "xform u9 û"
    - "xform o9 ô"
    - "xform m9 m̂"
    - "xform ng9 n̂g"
    - "xform a0 ǎ"
    - "xform e0 ě"
    - "xform i0 ǐ"
    - "xform u0 ǔ"
    - "xform o0 ǒ"
    - "xform ng0 ňg"
    - "xform a- ā"
    - "xform e- ē"
    - "xform i- ī"
    - "xform u- ū"
    - "xform o- ō"
    - "xform m- m̄"
    - "xform ng- n̄g"
    - "xform a; a̍"
    - "xform e; e̍"
    - "xform i; i̍"
    - "xform u; u̍"
    - "xform o; o̍"
    - "xform mh; m̍h"
    - "xform ngh; n̍gh"
  comment_format:
    - 'xform ([aeiou])(r?m?n*h?g?p?t?k?)([\[/\\\]90\-;]) $1$2$3'
    - 'xform ([aeo])([iueo])([\[/\\\]90\-;]) $1$2$3'
    #======================================================
    # 對於已輸入（韻母）（調號）之拼音，需在韻母標「聲調符號」
    #======================================================
    - xlit|[/\]90-;|¹²³⁴⁵⁶⁷⁸|
    # - xform/([aeiou])(r?m?n*h?g?p?t?k?)([12345678])/$1$2$3/
    # - xform/([aeo])([iueo])([12345678])/$1$2$3/
    #======================================================
    # 鼻化符號顯示成上標
    #======================================================
    - xform/nn(h?)(\d|\>)/$1ⁿ$2/

reverse_lookup:
  dictionary: luna_pinyin
  prefix: "`"
  tips: 〔拼音〕
  preedit_format:
    - xform/([nljqxy])v/$1ü/

punctuator:
  import_preset: default

recognizer:
  import_preset: default
  patterns:
    reverse_lookup: "`[a-z]*$"

style:
  horizontal: false
